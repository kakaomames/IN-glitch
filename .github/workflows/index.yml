name: Proxy Site Expedition

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - name: ğŸ“¦ ã‚³ãƒ¼ãƒ‰ã‚’ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆ
      uses: actions/checkout@v4
      # éšŠé•·æ³¨: ã“ã“ã§ãƒªãƒã‚¸ãƒˆãƒªã®å…¨ãƒ‡ãƒ¼ã‚¿ãŒä»®æƒ³ãƒã‚·ãƒ³ã«ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã‚‹ãï¼

    - name: ğŸŸ¢ Node.js ç’°å¢ƒã‚’ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
      uses: actions/setup-node@v4
      with:
        node-version: '20' # ç›¸å½“å‰ã®ã‚‚ã®ãªã‚‰ãƒãƒ¼ã‚¸ãƒ§ãƒ³èª¿æ•´ãŒå¿…è¦ã‹ã‚‚ãªï¼
      # node_version = '20'
      # print(f"Node.js Version: {node_version}")

    - name: ğŸ“¥ ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
      run: |
        if [ -f package-lock.json ]; then
          npm ci
        else
          npm install
        fi
      # install_command = "npm ci" (lockãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚‹å ´åˆ)
      # print(f"Executing: {install_command}")

    - name: ğŸš€ ãƒ—ãƒ­ã‚­ã‚·èµ·å‹•ãƒ†ã‚¹ãƒˆ
      run: |
        # ãƒ—ãƒ­ã‚­ã‚·ãŒæ­£å¸¸ã«ç«‹ã¡ä¸ŠãŒã‚‹ã‹ã€30ç§’ã ã‘å‹•ã‹ã—ã¦ã¿ã‚‹ä½œæˆ¦ã ï¼
        # ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§èµ·å‹•ã—ã¦ã€curlã§å©ã„ã¦ã¿ã‚‹ãã€‚
        node index.js & 
        echo "proxy_status: starting..."
        sleep 5
        curl -I http://localhost:8080 || exit 1
        echo "proxy_status: online! success!"
      # test_result = "success"
      # print(f"Test Status: {test_result}")
